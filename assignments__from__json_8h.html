<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CBMC: /home/runner/work/cbmc/cbmc/jbmc/src/java_bytecode/assignments_from_json.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CBMC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('assignments__from__json_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">assignments_from_json.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="code__with__references_8h_source.html">code_with_references.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for assignments_from_json.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="assignments__from__json_8h__incl.svg" width="1015" height="739"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="assignments__from__json_8h__dep__incl.svg" width="472" height="171"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="assignments__from__json_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a535a26c0ef50ff38b34e3333b8c296c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcode__with__references__listt.html">code_with_references_listt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="assignments__from__json_8h.html#a535a26c0ef50ff38b34e3333b8c296c6">assign_from_json</a> (const <a class="el" href="classexprt.html">exprt</a> &amp;expr, const <a class="el" href="classjsont.html">jsont</a> &amp;<a class="el" href="json__irep_8h.html#a431388bdfc99dd69a01601e780dd0aef">json</a>, const <a class="el" href="irep_8h.html#a1ad4faefa9ca542d481e74be9cc01c2c">irep_idt</a> &amp;function_id, <a class="el" href="classsymbol__table__baset.html">symbol_table_baset</a> &amp;symbol_table, <a class="el" href="optional_8h.html#ad5436a839660990c49c85e1b84723a69">optionalt</a>&lt; <a class="el" href="classci__lazy__methods__neededt.html">ci_lazy_methods_neededt</a> &gt; &amp;needed_lazy_methods, size_t max_user_array_length, std::unordered_map&lt; std::string, <a class="el" href="structobject__creation__referencet.html">object_creation_referencet</a> &gt; &amp;references)</td></tr>
<tr class="memdesc:a535a26c0ef50ff38b34e3333b8c296c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given an expression <code>expr</code> representing a Java object or primitive and a JSON representation <code>json</code> of the value of a Java object or primitive of a compatible type, adds statements to <code>block</code> to assign <code>expr</code> to the deterministic value specified by <code>json</code>.  <a href="assignments__from__json_8h.html#a535a26c0ef50ff38b34e3333b8c296c6">More...</a><br /></td></tr>
<tr class="separator:a535a26c0ef50ff38b34e3333b8c296c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a535a26c0ef50ff38b34e3333b8c296c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a535a26c0ef50ff38b34e3333b8c296c6">&#9670;&nbsp;</a></span>assign_from_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcode__with__references__listt.html">code_with_references_listt</a> assign_from_json </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classexprt.html">exprt</a> &amp;&#160;</td>
          <td class="paramname"><em>expr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classjsont.html">jsont</a> &amp;&#160;</td>
          <td class="paramname"><em>json</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="irep_8h.html#a1ad4faefa9ca542d481e74be9cc01c2c">irep_idt</a> &amp;&#160;</td>
          <td class="paramname"><em>function_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsymbol__table__baset.html">symbol_table_baset</a> &amp;&#160;</td>
          <td class="paramname"><em>symbol_table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="optional_8h.html#ad5436a839660990c49c85e1b84723a69">optionalt</a>&lt; <a class="el" href="classci__lazy__methods__neededt.html">ci_lazy_methods_neededt</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>needed_lazy_methods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_user_array_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unordered_map&lt; std::string, <a class="el" href="structobject__creation__referencet.html">object_creation_referencet</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>references</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given an expression <code>expr</code> representing a Java object or primitive and a JSON representation <code>json</code> of the value of a Java object or primitive of a compatible type, adds statements to <code>block</code> to assign <code>expr</code> to the deterministic value specified by <code>json</code>. </p>
<p>The expected format of the JSON representation is mostly the same as that of the json-io serialization library (<a href="https://github.com/jdereg/json-io">https://github.com/jdereg/json-io</a>) if run with the following options, as of version 4.10.1:</p><ul>
<li>A type name map with identity mappings such as <code>("java.lang.Boolean", "java.lang.Boolean")</code> for all primitive wrapper types, java.lang.Class, java.lang.String and java.util.Date. That is, we are not using the json-io default shorthands for those types.</li>
<li><code>WRITE_LONGS_AS_STRINGS</code> should be set to <code>true</code> to avoid a loss of precision when representing longs.</li>
</ul>
<p>Some examples of json-io representations that may not be obvious include:</p><ul>
<li>The representation of a Java object generally may or may not contain a <code>"@type"</code> key. The value corresponding to such a key specifies the runtime type of the object (or the boxed type if the object is primitive). If no <code>"@type"</code> key is present, it is assumed that the runtime type is the same as the compile-time type. Most reference-typed objects are represented as JSON objects (i.e. key-value maps) either way, so the <code>"@type"</code> key is just an additional key in the map. However, primitive types, arrays and string types without a <code>"@type"</code> key are not represented as JSON objects. For example, "untyped" ints are just represented as e.g. 1234, i.e. a JSON number. The "typed" version of this int then becomes <code>{"@type":"java.lang.Integer","value":1234}</code>, i.e. a JSON object, with the original ("untyped") JSON number stored in the "value" entry. For arrays, the corresponding key is called "@items", not "value". Typed versions of primitive types are probably not necessary, but json-io will sometimes produce such values, which is why we support both typed and untyped versions.</li>
<li>The way we deal with reference-equal objects is that they all get assigned the same ID, and exactly one of them will have an <code>{"@id": some_ID}</code> entry, in addition to its usual representation. All the other objects with this ID are represented simply as <code>{"@ref": some_ID}</code>, with no further entries.</li>
</ul>
<p>The above rule has the following exceptions:</p><ul>
<li>It seems that strings are always printed in "primitive" representation by json-io, i.e. they are always JSON strings, and never JSON objects with a <code>@type</code> key. For cases where we don't know that an expression has a string type (e.g. if its type is generic and specialized to java.lang.String), we need to sometimes represent strings as JSON objects with a <code>@type</code> key. In this case, the content of the string will be the value associated with a <code>value</code> key (similarly to StringBuilder in json-io). See <a class="el" href="assignments__from__json_8cpp.html#ac7927787bb04cb7712e5cc547584655f">get_untyped_string</a>.</li>
<li>json-io does not include the <code>ordinal</code> field of enums in its representation, but our algorithm depends on it being present. It may be possible to rewrite parts of it to set the ordinal depending on the order of elements seen in the <code>$VALUES</code> array, but it would generally make things more complicated.</li>
</ul>
<p>For examples of JSON representations of objects, see the regression tests for this feature in jbmc/regression/jbmc/deterministic_assignments_json.</p>
<p>Known limitations:</p><ul>
<li>If two reference-equal objects are defined in the same function, they are correctly assigned the same value. However, the case where they are defined in two different functions is not supported. The object that is stored as a <code>{"@ref":1}</code> or similar will generally either point to a freshly allocated symbol or an out-of-scope symbol. The <code>{"@id":1}</code> (or similar) object may be assigned correctly, or it may point to an out-of-scope symbol. This is because the symbol for the shared value is currently allocated dynamically. To fix this limitation, static allocation would have to be used instead, together with a static boolean to keep track of whether or not the symbol has been allocated already.</li>
<li>The special floating-point values NaN and positive/negative infinity are not supported. Note that in json-io 4.10.1, these are printed as "null". Future versions of json-io will support these values, and this function should be consistent with that if possible.</li>
<li>json-io prints \uFFFF as a single character, which is not read correctly by the JSON parser.</li>
<li>Not all assignments have source locations, and those that do only link to a function, not a line number.</li>
</ul>
<p>For parameter documentation, see <a class="el" href="structobject__creation__infot.html">object_creation_infot</a>. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a263634046f766d6a2cc27bb1bac298e.html">jbmc</a></li><li class="navelem"><a class="el" href="dir_7d9c2272cea08e738f9482db6f677351.html">src</a></li><li class="navelem"><a class="el" href="dir_1a9aed0dd48ec371a7d28ba0a5a70e7e.html">java_bytecode</a></li><li class="navelem"><a class="el" href="assignments__from__json_8h.html">assignments_from_json.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
